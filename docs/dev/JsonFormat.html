
<!DOCTYPE html>

<html lang="fr">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Format de fichier de configuration d’un équipement (JSON) &#8212; Documentation Abeille 11.02.2021</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Recherche" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/Abeille_icon.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Recherche rapide</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../Bienvenu.html">Bienvenu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Presentation.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Equipements.html">Equipements supportés</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Utilisation.html">Utilisation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../UtilisationAvancee.html">Utilisation avancée</a></li>
<li class="toctree-l1"><a class="reference internal" href="../AjoutNouvelEquipement.html">Ajout d’un nouvel équipement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../FAQ.html">Questions fréquentes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Divers.html">Divers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DIY.html">Do It Yourself</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Debug.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Developpement.html">Developpement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Changelog.html">ChangeLog</a></li>
</ul>


        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="format-de-fichier-de-configuration-d-un-equipement-json">
<h1>Format de fichier de configuration d’un équipement (JSON)<a class="headerlink" href="#format-de-fichier-de-configuration-d-un-equipement-json" title="Lien permanent vers ce titre">¶</a></h1>
<p>Les équipements supportés sont décrits dans des fichiers au format JSON, discuté ci-après.
Ces fichiers se trouvent dans « core/config/devices » pour les équipement supportés nativement par Abeille ou « core/config/devices_local » pour les équipements perso/custom ou en cours de développement et non encore inclus dans Abeille.</p>
<p>Exemple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="s2">&quot;BASICZBR3&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;Sonoff BASICZBR3 smart switch&quot;</span><span class="p">,</span>
    <span class="s2">&quot;manufacturer&quot;</span><span class="p">:</span> <span class="s2">&quot;Sonoff&quot;</span><span class="p">,</span>
    <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="s2">&quot;BASICZBR3&quot;</span><span class="p">,</span>
    <span class="s2">&quot;timeout&quot;</span><span class="p">:</span> <span class="s2">&quot;60&quot;</span><span class="p">,</span>
    <span class="s2">&quot;category&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;automatism&quot;</span><span class="p">:</span> <span class="s2">&quot;1&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;configuration&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;icon&quot;</span><span class="p">:</span> <span class="s2">&quot;BASICZBR3&quot;</span><span class="p">,</span>
      <span class="s2">&quot;mainEP&quot;</span><span class="p">:</span> <span class="s2">&quot;02&quot;</span>
      <span class="s2">&quot;batteryType&quot;</span><span class="p">:</span> <span class="s2">&quot;1x3V CR2032&quot;</span><span class="p">,</span>
      <span class="s2">&quot;lastCommunicationTimeOut&quot;</span><span class="p">:</span> <span class="s2">&quot;-1&quot;</span><span class="p">,</span>
      <span class="s2">&quot;paramType&quot;</span><span class="p">:</span> <span class="s2">&quot;telecommande&quot;</span><span class="p">,</span>
      <span class="s2">&quot;paramBatterie&quot;</span><span class="p">:</span> <span class="s2">&quot;true&quot;</span>
    <span class="p">},</span>
    <span class="s2">&quot;commands&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="s2">&quot;Groups&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;Group-Membership&quot;</span> <span class="p">},</span>

      <span class="s2">&quot;Status&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;zb-0006-OnOff&quot;</span><span class="p">,</span> <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;nextLine&quot;</span><span class="p">:</span> <span class="s2">&quot;after&quot;</span> <span class="p">},</span>
      <span class="s2">&quot;On&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;zbCmd-0006-On&quot;</span><span class="p">,</span> <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
      <span class="s2">&quot;Off&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;zbCmd-0006-Off&quot;</span><span class="p">,</span> <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
      <span class="s2">&quot;Toggle&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;zbCmd-0006-Toggle&quot;</span> <span class="p">},</span>
      <span class="s2">&quot;Up&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;zbCmdR-Custom&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="s2">&quot;ep=01&amp;clustId=0006&amp;cmdId=01&quot;</span><span class="p">,</span> <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">},</span>
      <span class="s2">&quot;Down&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;zbCmdR-Custom&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="s2">&quot;ep=02&amp;clustId=0006&amp;cmdId=00&quot;</span><span class="p">,</span> <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="mi">1</span> <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul>
<li><p>type: OBLIGATOIRE (anciennement “nameJeedom”)</p>
<p>Type d’équipement. Ex: « Tuya smart socket »</p>
</li>
<li><p>manufacturer: OBLIGATOIRE</p>
<p>Nom du fabricant.
Exemple: « Sonoff »</p>
</li>
<li><p>model: OBLIGATOIRE</p>
<p>Modèle ou référence exacte du fabricant. Exemple: « BASICZBR3 »</p>
</li>
<li><p>timeout</p>
<p>Durée (en min) au dela de laquelle l’équipement est considéré comme HS si aucune nouvelle de lui.</p>
</li>
<li><p>comment: Optionnel</p>
<p>Permet d’ajouter un commentaire pour cet équipement.</p>
</li>
<li><p>category</p>
<p>Exemple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;category&quot;</span><span class="p">:{</span><span class="s2">&quot;automatism&quot;</span><span class="p">:</span><span class="s2">&quot;1&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Liste les categories (plusieurs possibles) correspondant à l’équipement.
Note: Ce paramètre permet d’initialiser le champ « category » de la table Jeedom « eqLogic ».</p>
<ul class="simple">
<li><p>light</p></li>
<li><p>heating</p></li>
<li><p>security</p></li>
<li><p>energy</p></li>
<li><p>automatism</p></li>
<li><p>multimedia</p></li>
<li><p>default</p></li>
</ul>
</li>
<li><p>configuration</p>
<p>Note: Ce paramètre permet d’initialiser le champ « configuration » de la table Jeedom « eqLogic ».</p>
<ul>
<li><p>icon</p>
<p>Nom de l’icone associé.</p>
</li>
<li><p>mainEP: OBLIGATOIRE</p>
<p>Defini le « End point » à utiliser par défaut si celui-ci n’est pas explicite dans la commande.</p>
</li>
<li><p>paramType</p>
<ul class="simple">
<li><p>telecommande</p></li>
<li><p>telecommande7groups</p></li>
</ul>
</li>
<li><p>batteryType: OBLIGATOIRE si équipement sur batterie</p>
<p>Description du type de batterie (ex: 1x3V CR2430)</p>
</li>
<li><p>paramBatterie: ??</p></li>
<li><p>lastCommunicationTimeOut: ??</p></li>
<li><p>GroupeEPx</p>
<p>Ex: « GroupeEP1 »: « 1001 »,</p>
</li>
</ul>
</li>
<li><p>commands</p>
<p>Exemple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;commands&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s2">&quot;&lt;premiere cmde Jeedom&gt;&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;cmde de base&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="s2">&quot;ep=XX&quot;</span> <span class="p">},</span>
    <span class="s2">&quot;&lt;deuxieme cmde Jeedom&gt;&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;cmde de base&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="s2">&quot;ep=XX&quot;</span><span class="p">,</span> <span class="s2">&quot;isVisible&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span><span class="p">,</span> <span class="s2">&quot;isHistorized&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span> <span class="p">},</span>
    <span class="o">...</span>
    <span class="s2">&quot;&lt;derniere cmde Jeedom&gt;&quot;</span><span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;use&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;cmde de base&gt;&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">:</span> <span class="s2">&quot;ep=XX&quot;</span><span class="p">,</span> <span class="s2">&quot;execAtCreation&quot;</span><span class="p">:</span> <span class="s2">&quot;yes&quot;</span> <span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Notes pour les commandes</p>
<ul class="simple">
<li><p>Les commande de base sont celles définies dans « core/config/commands »</p></li>
<li><p>« ep » permet de préciser le EP (End Point). Si il n’est pas défini, « mainEP » sera utilisé.</p></li>
<li><p>« execAtCreation » permet de préciser que cette commande doit etre executée pendant l’inclusion pour configurer l’equipement.
Par défaut la commande n’est pas exécutée.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="format-fichier-de-commande-json">
<h1>Format fichier de commande (JSON)<a class="headerlink" href="#format-fichier-de-commande-json" title="Lien permanent vers ce titre">¶</a></h1>
<p>Ces fichiers se trouvent dans « core/config/commands ».</p>
<p>Exemple</p>
<blockquote>
<div><dl>
<dt>{</dt><dd><dl>
<dt>« BindShortToZigateBatterie »: {</dt><dd><p>« isVisible »: 0,
« name »: « BindShortToZigateBatterie »,
« isHistorized »: 0,
« Type »: « action »,
« subType »: « other »,
« invertBinary »: « 0 »,
« template »: «  »,
« configuration »: {</p>
<blockquote>
<div><p>« topic »: « bindShort »,
« request »: « targetExtendedAddress=#addrIEEE#&amp;targetEndpoint=#EP#&amp;ClusterId=0001&amp;reportToAddress=#ZiGateIEEE# »,
« visibilityCategory »: « Network »,
« minValue »: « 0 »,
« maxValue »: « 90 »,
« historizeRound »: « 0 »,
« calculValueOffset »: «  »,
« execAtCreation »: « Yes »,
« execAtCreationDelay »: « 9 »,
« repeatEventManagement »: « always »,
« visibiltyTemplate »: « 1 »,
« RefreshData »: « 1 »,</p>
</div></blockquote>
<p>}</p>
</dd>
</dl>
<p>}</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<ul>
<li><p>Clef d’entrée (BindShortToZigateBatterie)</p>
<blockquote>
<div><p>Devient « logicalId » de la commande. Il n’est pas forcement en ligne avec le nom du fichier.</p>
</div></blockquote>
</li>
<li><p>name: OBLIGATOIRE</p>
<blockquote>
<div><p>Nom Jeedom de la commande</p>
</div></blockquote>
</li>
<li><p>Type &amp; subType: OBLIGATOIRE</p>
<blockquote>
<div><p>Type = “info” ou “action”
subType = “numeric”, “string”, “binary”, “other”</p>
</div></blockquote>
</li>
<li><p>invertBinary: Optionnel. Utilisé par Jeedom pour inverser le résultat d’une commande info du type « binary ».</p>
<blockquote>
<div><p>TODO: Devrait etre dans la section « display ».</p>
</div></blockquote>
</li>
<li><p>order: OBSOLETE</p>
<blockquote>
<div><p>L’ordre d’affichage des commandes est par défaut celui de leur déclaration dans le fichier de config « équipement ».</p>
</div></blockquote>
</li>
<li><p>configuration</p>
<blockquote>
<div><ul>
<li><p>topic: Nom Abeille de la commande</p></li>
<li><p>request: parametres associés à “topic”</p></li>
<li><p>minValue:</p></li>
<li><p>maxValue:</p></li>
<li><p>historizeRound: ?</p></li>
<li><p>calculValueOffset: Indique à Jeedom d’appliquer une formule sur la valeur reçue.</p>
<blockquote>
<div><p>Ex: « calculValueOffset »: « #value#/10 »,
Ex: « calculValueOffset »: « #value#/255*100 »</p>
</div></blockquote>
</li>
<li><p>repeatEventManagement: ?</p></li>
<li><p>visibiltyTemplate: ? Semble ne pas etre utilisé du tout, ni par Jeedom ni par Abeille.</p></li>
<li><p>RefreshData: ?</p></li>
<li><p>uniqId: OBSOLETE</p></li>
</ul>
</div></blockquote>
</li>
<li><p>display: Options d’affichage optionnelles.</p>
<blockquote>
<div><ul class="simple">
<li><p>forceReturnLineAfter: Force le passage à la ligne après l’affichage du widget.</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="variables-de-personalisation">
<h1>Variables de personalisation<a class="headerlink" href="#variables-de-personalisation" title="Lien permanent vers ce titre">¶</a></h1>
<p>De manière à pouvoir utiliser des commandes génériques, un certain nombre de variables permettent de personaliser la commande lors de son utilisation par l’équipement.</p>
<blockquote>
<div><ul class="simple">
<li><p>#addrIEEE# ou #ADDR#: Adresse IEEE de l’équipement</p></li>
<li><p>#ZiGateIEEE#: Adresse IEEE de la zigate</p></li>
<li><p>#EP#: End Point</p></li>
</ul>
</div></blockquote>
</div>
<div class="section" id="normalisation-des-commandes-de-base-zigbee">
<h1>Normalisation des commandes de base zigbee<a class="headerlink" href="#normalisation-des-commandes-de-base-zigbee" title="Lien permanent vers ce titre">¶</a></h1>
<p>EN COURS DE REFLEXION/DEVELOPPEMENT !!</p>
<p>Les commandes de base sont les commandes internes à Abeille.
Parmi elles, il y a les commandes zigbee directement issues du standard et normalisées ci-apres:</p>
<ul class="simple">
<li><p>attribut R =&gt; zbGet-&lt;ClustId&gt;-&lt;AttribName&gt; (ex: zgGet-0000-ModelIdentifier)</p></li>
<li><p>attribut value =&gt; zb-&lt;ClustId&gt;-&lt;AttribName&gt; (ex: zb-0000-ModelIdentifier)</p></li>
<li><p>attribut W =&gt; zbSet-&lt;ClustId&gt;-&lt;AttribName&gt;</p></li>
<li><p>command =&gt; zbCmd-&lt;ClustId&gt;-&lt;CmdName&gt; (ex: zbCmd-0003-Identify)</p></li>
<li><p>command reçue =&gt; zbCmdR-&lt;ClustId&gt;-&lt;CmdName&gt; (ex: zbCmd-0003-Identify)</p></li>
</ul>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>

    <div class="footer">
      &copy;2019-22, KiwiHC16.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.1.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>